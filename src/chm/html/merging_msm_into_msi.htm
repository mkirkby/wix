<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <link rel="stylesheet" type="text/css" href="style.css" />

  <title>Creating Merge Modules</title>
    <style type="text/css">
        .style1
        {
            color: #0000FF;
            font-weight: bold;
        }
        .style2
        {
            color: #0000FF;
        }
    </style>
</head>

<body>
    <h1>Incorporating a Merge Module into a .wxs File</h1>

  <p>Merge Modules can only be merged into Windows Installer packages. Once you have a .wxs file that creates a Windows Installer package, 
      it&#39;s just a matter of adding two lines (yes, only two lines are necessary) to merge 
      a new Module. In your .wxs source file, add the following lines:</p>
  <pre>
&lt;?xml version='1.0'?&gt;
&lt;Wix xmlns='http://schemas.microsoft.com/wix/2006/wi'&gt;
   &lt;Product Id='PUT-GUID-HERE' Name='Test Package' Language='1033'
             Version='1.0.0.0' Manufacturer='Microsoft Corporation'&gt;
      &lt;Package Description='My first Windows Installer package'
               Comments='This is my first attempt at creating a Windows Installer database'
               Manufacturer='Microsoft Corporation' InstallerVersion='200' Compressed='yes' /&gt;
 
      &lt;Media Id='1' Cabinet='product.cab' EmbedCab='yes' /&gt;
 
      &lt;Directory Id='TARGETDIR' Name='SourceDir'&gt;
         &lt;Directory Id='ProgramFilesFolder' Name='PFiles'&gt;
            &lt;Directory Id='MyDir' Name='Test Program'&gt;
               &lt;Component Id='MyComponent' Guid='PUT-GUID-HERE'&gt;
                  &lt;File Id='readme' Name='readme.txt' DiskId='1' Source='readme.txt' /&gt;
               &lt;/Component&gt;
 
             <span class="style2">  </span><span class="style1">&lt;Merge Id='MyModule' Language='1033' SourceFile='module.msm' DiskId='1' /&gt;</span>
            &lt;/Directory&gt;
         &lt;/Directory&gt;
      &lt;/Directory&gt;
 
      &lt;Feature Id='MyFeature' Title='My 1st Feature' Level='1'&gt;
         &lt;ComponentRef Id='MyComponent' /&gt;
         <span class="style1">&lt;MergeRef Id='MyModule' /&gt;</span>
      &lt;/Feature&gt;
   &lt;/Product&gt;
&lt;/Wix&gt;
</pre>

  <p>Now when you compile your Windows Installer package source file, it will include the installation logic and files from the Merge Module. </p>
  <pre>
C:\test&gt; <span class="style2"><strong>candle product.wxs</strong></span>
Microsoft (R) Windows Installer Xml Compiler version 1.0.1220.15022
Copyright (C) Microsoft Corporation 2003. All rights reserved
 
product.wxs
 
C:\test&gt; <span class="style2"><strong>light product.wixobj</strong></span>
Microsoft (R) Windows Installer Xml Linker version 1.0.1220.15022
Copyright (C) Microsoft Corporation 2003. All rights reserved</pre>
    <p>Now when you install the package, you will see that it creates a directory called 
        &quot;Test Program&quot; in your system&#39;s &quot;Program Files&quot; folder. The files readme.txt and 
        readme2.txt will be installed in the &quot;Test Program&quot; directory. </p>
</body>
</html>
