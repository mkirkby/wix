<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <link rel="stylesheet" type="text/css" href="style.css" />

  <title>Authoring your first .wxs file</title>
    <style type="text/css">
        .style1
        {
            color: #0000FF;
        }
        .style2
        {
            color: #0000FF;
            font-weight: bold;
        }
    </style>
</head>

<body>
  <h1>Creating a Simple Setup</h1>

  <p>The goal of this tutorial is to help you to get familiar with WiX and the fundmental building blocks in order to build a simple installable .msi package using WiX. We will start with the basic WiX code to create an .msi package that installs one file.</p>

  <h2>Step 1: Create the WiX source file</h2>
    <p>To get started, pick your favorite XML editor (such as Notepad or Visual Studio) and create a new file called product.wxs. Nothing about that name is special, but the .wxs extension lets us know that this is a Windows Installer XML source file. Next, add the three lines of text that all .wxs files must contain:</p>
  <pre>
<b><span class="style1">&lt;?xml version='1.0'?&gt;</span>
<span class="style1">&lt;Wix xmlns='http://schemas.microsoft.com/wix/2006/wi'&gt;</span>
<span class="style1">&lt;/Wix&gt;</span></b>
</pre>

  <p>That forms the outer skeleton for our source file. Save the file in the same 
      directory as where the WiX tools are installed (e.g. C:\test).</p>

  <h2>Step 2: Author the content of the package</h2>
    <p>Okay, now that we&#39;ve created an empty source file, let&#39;s create an installable 
        Windows Installer package. Add the following content to your product.wxs file:</p>
  <pre>
&lt;?xml version='1.0'?&gt;
&lt;Wix xmlns='http://schemas.microsoft.com/wix/2006/wi'&gt;
<b><span class="style1">   &lt;Product Id='PUT-GUID-HERE' Name='Test Package' Language='1033' </span>
<span class="style1">            Version='1.0.0.0' Manufacturer='Microsoft Corporation' UpgradeCode='PUT-GUID-HERE' &gt;</span>
<span class="style1">      &lt;Package Description='My first Windows Installer package'</span>
<span class="style1">               Comments='This is my first attempt at creating a Windows Installer database'</span>
<span class="style1">               Manufacturer='Microsoft Corporation' InstallerVersion='200' Compressed='yes' /&gt;</span>

<span class="style1">      &lt;Directory Id='TARGETDIR' Name='SourceDir'&gt;</span>
<span class="style1">         &lt;Component Id='MyComponent' Guid='PUT-GUID-HERE' /&gt;</span>
<span class="style1">      &lt;/Directory&gt;</span>
<span class="style1"><br />      &lt;Feature Id='MyFeature' Title='My 1st Feature' Level='1'&gt;</span>
<span class="style1">         &lt;ComponentRef Id='MyComponent' /&gt;</span>
<span class="style1">      &lt;/Feature&gt;</span>
<span class="style1">   &lt;/Product&gt;</span></b>
&lt;/Wix&gt;
</pre>

  <p>Replace PUT-GUID-HERE with a GUID value. This will allow you to create an .msi with a ProductCode of "{PUT-GUID-HERE}" with a ProductLanguage of "1033" and a ProductVersion of "1.0.0.0". All of that information is taken from the &lt;Product&gt; element. The &lt;Package&gt; element defines all of the information that goes in our .msi's summary information stream. Finally, a simple &lt;Directory&gt; and &lt;Feature&gt; tree is created with a single &lt;Component&gt;. This is enough to get our .msi registered on the machine.</p>

    <h2>Step 3: Adding a file to the package</h2>
    <p>Now that we have the directory authored, let&#39;s put a file in the folder. Create a new text file called readme.txt in the same directory as the product.wxs file and type a message such as "Hello, World!" in the file. Then, we need to modify product.wxs to tell it about the file:</p>
  <pre>
&lt;?xml version='1.0'?&gt;&lt;Wix xmlns='http://schemas.microsoft.com/wix/2006/wi'&gt;
   &lt;Product Id='PUT-GUID-HERE' Name='Test Package' Language='1033'
            Version='1.0.0.0' Manufacturer='Microsoft Corporation' UpgradeCode='PUT-GUID-HERE'&gt;
      &lt;Package Description='My first Windows Installer package'
                Comments='This is my first attempt at creating a Windows Installer database'
                Manufacturer='Microsoft Corporation' InstallerVersion='200' Compressed='yes' /&gt;
 
    <span class="style1">  </span><span class="style2">&lt;Media Id='1' Cabinet='product.cab' EmbedCab='yes' /&gt;</span>
 
      &lt;Directory Id='TARGETDIR' Name='SourceDir'&gt;
<span class="style1">         </span><b><span class="style1">&lt;Directory Id='ProgramFilesFolder' Name='PFiles'&gt;</span>
<span class="style1">            &lt;Directory Id='MyDir' Name='Test Program'&gt;</span>
               </b>&lt;Component Id='MyComponent' Guid='PUT-GUID-HERE'&gt;<b>
                  <span class="style1">&lt;File Id='readme' Name='readme.txt' DiskId='1' Source='readme.txt' /&gt;</span>
<span class="style1">               &lt;/Component&gt;</span>
<span class="style1">            &lt;/Directory&gt;</span>
<span class="style1">         &lt;/Directory&gt;</span></b>
      &lt;/Directory&gt;
 
      &lt;Feature Id='MyFeature' Title='My 1st Feature' Level='1'&gt;
         &lt;ComponentRef Id='MyComponent' /&gt;
      &lt;/Feature&gt;
   &lt;/Product&gt;
&lt;/Wix&gt;
</pre>

    <h2>Step 4: Build the package</h2>
    <p>Now let's build the package using the following instructions:</p>

  <pre>
C:\test&gt; <span class="style2">candle product.wxs</span>
Microsoft (R) Windows Installer Xml Compiler version 1.0.1220.15022
Copyright (C) Microsoft Corporation 2003. All rights reserved
 
product.wxs
 
C:\test&gt; <span class="style2">light product.wixobj</span>
Microsoft (R) Windows Installer Xml Linker version 1.0.1220.15022
Copyright (C) Microsoft Corporation 2003. All rights reserved</pre>
    <h2>
        Step 5: Verify the package</h2>
    <p>
        We can now try installing the resulting package and look at the result. Note 
        that msi packages requires administrative privileges in order to install 
        correctly. If will fail silently if you are not installing as an Administrator.</p>
    <pre>
 C:\test&gt; <span class="style2">msiexec /i product.msi</span>
</pre>

  <p>You can now go to Add/Remove Programs in the Control Panel and see &quot;Test Package&quot; 
      listed there. You can also see that it creates a directory called &quot;Test Program&quot; 
      in your system&#39;s &quot;Program Files&quot; folder. The file readme.txt will be installed 
      in the &quot;Test Program&quot; directory. After verifying that installation works as 
      expected, remember to uninstall the .msi so you can rebuild it and install a new 
      version again later.</p>

  <p>That's all there is to creating a Windows Installer package. You can do many more advanced things, such as adding setup UI to your .msi, but we've covered the basics. Everything just comes down to filling in the right XML elements.</p>

  <h2>&nbsp;</h2>

  <h2>&nbsp;</h2>
</body>
</html>
